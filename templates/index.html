<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Simulasi Angsuran</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      #rate_hasil {
        cursor: not-allowed;
      }
    </style>
  </head>
  <body class="bg-light">
    <div class="container py-5">
      <!-- Logo Atas -->
      <div class="text-center mb-4">
        <img src="/static/astra-logo@2x.png" alt="Logo" class="img-fluid" />
      </div>

      <div class="row justify-content-center">
        <div class="col-md-6">
          <div class="card shadow-lg border-0 rounded-3">
            <div class="card-header bg-primary text-white text-center">
              <h4 class="mb-0">Simulasi Angsuran</h4>
            </div>
            <div class="card-body p-4">
              <form method="post">
                <div class="mb-3">
                  <label class="form-label">Nama Customer</label>
                  <div class="input-group">
                    <span class="input-group-text">Name</span>
                    <input
                      type="text"
                      name="namecstm"
                      class="form-control"
                      placeholder="Masukkan nama customer"
                      autofocus
                      required
                    />
                  </div>
                </div>

                <!-- Pokok Pinjaman -->
                <div class="mb-3">
                  <label class="form-label">Pokok Pinjaman</label>
                  <div class="input-group">
                    <span class="input-group-text">Rp</span>
                    <input
                      type="text"
                      id="pokok"
                      name="pokok"
                      class="form-control"
                      placeholder="Masukkan jumlah pinjaman"
                      required
                      oninput="formatRupiah(this)"
                    />
                  </div>
                  <div class="form-text">Minimal Rp 50.000.000</div>
                </div>

                <!-- Metode -->
                <div class="mb-3">
                  <label class="form-label">Metode</label>
                  <select
                    name="metode"
                    id="metode"
                    class="form-select"
                    required
                  >
                    <option value="efektif">Efektif</option>
                    <option value="flat">Flat</option>
                  </select>
                </div>

                <!-- Bunga -->
                <div class="mb-3">
                  <label class="form-label" id="label_bunga"
                    >Bunga Tahunan (Efektif)</label
                  >
                  <div class="input-group">
                    <input
                      type="number"
                      step="0.01"
                      id="bunga"
                      name="bunga"
                      class="form-control"
                      placeholder="Contoh: 10"
                      required
                      oninput="hitungRate()"
                    />
                    <span class="input-group-text">%</span>
                  </div>
                </div>

                <!-- Hasil Konversi -->
                <div class="mb-3">
                  <label class="form-label" id="label_hasil">Rate Flat</label>
                  <div class="input-group">
                    <input
                      type="text"
                      id="rate_hasil"
                      class="form-control"
                      readonly
                      disabled
                      placeholder="Auto generated"
                    />
                    <span class="input-group-text">%</span>
                  </div>
                  <div class="form-text text-muted">
                    Nilai ini dihitung otomatis dari bunga tahunan. Tidak perlu
                    diisi.
                  </div>
                </div>

                <!-- Tenor -->
                <div class="mb-3">
                  <label class="form-label">Tenor</label>
                  <div class="input-group">
                    <input
                      type="number"
                      name="tenor"
                      class="form-control"
                      placeholder="Contoh: 12"
                      required
                    />
                    <span class="input-group-text">bulan</span>
                  </div>
                </div>

                <!-- Tanggal Pencairan -->
                <div class="mb-3">
                  <label class="form-label">Tanggal Pencairan</label>
                  <input
                    type="date"
                    name="start_date"
                    class="form-control"
                    required
                  />
                </div>

                <!-- Tanggal Pembayaran Pertama -->
                <div class="mb-3">
                  <label class="form-label">Tanggal Pembayaran Pertama</label>
                  <input
                    type="date"
                    name="first_due_date"
                    class="form-control"
                  />
                </div>

                <!-- Tombol -->
                <div class="d-grid">
                  <button type="submit" class="btn btn-primary btn-lg">
                    Hitung Simulasi
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>

      <!-- Footer dengan Logo -->
      <footer class="text-center mt-5">
        <p class="text-muted small mb-0">
          Â© 2025 Simulasi Angsuran | Made By Raden
        </p>
      </footer>
    </div>
  </body>

  <script>
    function formatRupiah(input) {
      let value = input.value.replace(/\D/g, "");
      if (value && parseInt(value) < 50000000) {
        input.setCustomValidity("Minimal pinjaman Rp 50.000.000");
      } else {
        input.setCustomValidity("");
      }
      input.value = new Intl.NumberFormat("id-ID").format(value);
    }

    function hitungRate() {
      let bunga = parseFloat(document.getElementById("bunga").value);
      let metode = document.getElementById("metode").value;
      let labelHasil = document.getElementById("label_hasil");
      let hasilField = document.getElementById("rate_hasil");
      let labelBunga = document.getElementById("label_bunga");

      if (!isNaN(bunga)) {
        if (metode === "efektif") {
          let flat = bunga / 1.81;
          labelBunga.textContent = "Bunga Tahunan (Efektif)";
          labelHasil.textContent = "Rate Flat";
          hasilField.value = flat.toFixed(2);
        } else {
          let efektif = bunga * 1.81;
          labelBunga.textContent = "Bunga Tahunan (Flat)";
          labelHasil.textContent = "Rate Efektif";
          hasilField.value = efektif.toFixed(2);
        }
      } else {
        hasilField.value = "";
      }
    }

    document.getElementById("metode").addEventListener("change", () => {
      // reset input & hasil saat ganti metode
      document.getElementById("bunga").value = "";
      document.getElementById("rate_hasil").value = "";
      hitungRate();
    });
  </script>
</html>
